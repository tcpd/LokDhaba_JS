version: "2"
services:
  db:
    container_name: ld_db
    image: mysql:8.0.15
    command: '--local-infile=1'
    ports:
      - '32000:3306'
    environment:
      MYSQL_ROOT_PASSWORD: root
    volumes:
      - './db/:/docker-entrypoint-initdb.d/:ro'
  api:
    build: ./LokdhabaApi
    container_name : ld_api
    volumes :
      - './LokdhabaApi/:/app/'
    links:
      - db
    ports:
      - "15000:5000"  
    command : flask run --host=0.0.0.0
    #  --workers 2 -b 0.0.0.0:5000 --timeout 60
    # command: gunicorn app:app -c gunicorn_config.py 
    #command: gunicorn -c gunicorn_config.py app:app
  node:
    container_name : ld_ui
    build : ./lokdhaba_js
    volumes :
      - './lokdhaba_js:/app'
      - '/app/node_modules'
    ports :
      - '3001:3000'
    links :
      - api